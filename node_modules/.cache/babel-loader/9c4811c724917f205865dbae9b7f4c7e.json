{"ast":null,"code":"import _classCallCheck from \"G:\\\\OSPanel\\\\domains\\\\new_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"G:\\\\OSPanel\\\\domains\\\\new_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"G:\\\\OSPanel\\\\domains\\\\new_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"G:\\\\OSPanel\\\\domains\\\\new_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"G:\\\\OSPanel\\\\domains\\\\new_react\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"G:\\\\OSPanel\\\\domains\\\\new_react\\\\src\\\\index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './style.css';\nimport './reset.css'; //import * as serviceWorker from './serviceWorker';\n\nimport io from 'socket.io-client';\nimport Linkify from 'linkifyjs/react';\nvar appSection = document.getElementById('chatApp');\nvar socket = io.connect('http://127.0.0.1:5000/', {\n  reconnect: true\n});\nvar helperFunctions = {\n  isEnterButton: function isEnterButton(e) {\n    return e.keyCode === 13 ? true : false;\n  },\n  isEnterCtrlButton: function isEnterCtrlButton(e) {\n    return (e.keyCode === 10 || e.keyCode === 13) && e.ctrlKey ? true : false;\n  },\n  isEmptyValue: function isEmptyValue(val) {\n    return val === '' ? true : false;\n  },\n  numericEnding: function numericEnding(number, one, two, five) {\n    var n = Math.abs(number);\n    n %= 100;\n\n    if (n >= 5 && n <= 20) {\n      return five;\n    }\n\n    n %= 10;\n\n    if (n === 1) {\n      return one;\n    }\n\n    if (n >= 2 && n <= 4) {\n      return two;\n    }\n\n    return five;\n  },\n  parseTime: function parseTime(date) {\n    var time = new Date(date);\n    return (\"0\" + time.getHours()).slice(-2) + \":\" + (\"0\" + time.getMinutes()).slice(-2) + \":\";\n  },\n  parseDate: function parseDate(date) {\n    var messageDate = new Date(date);\n    var searchDate = new Date();\n    if (helperFunctions.compareDates(messageDate, searchDate)) return \"Сегодня\";\n    searchDate.setDate(searchDate.getDate() - 1);\n    if (helperFunctions.compareDates(messageDate, searchDate)) return \"Вчера\";\n    return messageDate.getDate() + '.' + messageDate.getMonth() + '.' + messageDate.getFullYear();\n  },\n  compareDates: function compareDates(date1, date2) {\n    return date1.getMonth() === date2.getMonth() && date1.getFullYear() === date2.getFullYear() && date1.getDate() === date2.getDate() ? true : false;\n  }\n};\n\nvar LoginWindow =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(LoginWindow, _React$Component);\n\n  function LoginWindow() {\n    _classCallCheck(this, LoginWindow);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(LoginWindow).apply(this, arguments));\n  }\n\n  _createClass(LoginWindow, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      return React.createElement(\"div\", {\n        className: \"username\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }, \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0438\\u043C\\u044F\"), React.createElement(\"input\", {\n        type: \"text\",\n        id: \"nickname\",\n        onKeyUp: function onKeyUp(e) {\n          return _this.props.checkEnterKey(e);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        className: \"userWarning\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, this.props.error));\n    }\n  }]);\n\n  return LoginWindow;\n}(React.Component);\n\nvar LoginApp =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(LoginApp, _React$Component2);\n\n  function LoginApp() {\n    var _getPrototypeOf2;\n\n    var _this2;\n\n    _classCallCheck(this, LoginApp);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(LoginApp)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this2.state = {\n      error: ''\n    };\n\n    _this2.checkEnterKey = function (e, val) {\n      var value = e.target.value.replace(/ /g, \"\");\n\n      if (helperFunctions.isEmptyValue(value)) {\n        _this2.incorrectLogin();\n\n        return;\n      }\n\n      _this2.clearError();\n\n      if (!helperFunctions.isEnterButton(e)) return;\n\n      _this2.sendLogin(value);\n    };\n\n    _this2.sendLogin = function (val) {\n      socket.emit('userName', {\n        'user': val\n      });\n    };\n\n    _this2.existLogin = function () {\n      _this2.setErrorStateFun('Такой пользователь уже есть');\n    };\n\n    _this2.incorrectLogin = function () {\n      _this2.setErrorStateFun('Недопустимое имя');\n    };\n\n    _this2.clearError = function () {\n      _this2.setErrorStateFun('');\n    };\n\n    _this2.setErrorStateFun = function (val) {\n      _this2.setState({\n        error: val\n      });\n    };\n\n    return _this2;\n  }\n\n  _createClass(LoginApp, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(LoginWindow, {\n        error: this.state.error,\n        checkEnterKey: this.checkEnterKey,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this3 = this;\n\n      socket.on('existUsername', function () {\n        _this3.existLogin();\n      });\n      socket.on('incorrectUsername', function () {\n        _this3.incorrectLogin();\n      });\n    }\n  }]);\n\n  return LoginApp;\n}(React.Component);\n\nvar ChatContainer =\n/*#__PURE__*/\nfunction (_React$Component3) {\n  _inherits(ChatContainer, _React$Component3);\n\n  function ChatContainer() {\n    var _getPrototypeOf3;\n\n    var _this4;\n\n    _classCallCheck(this, ChatContainer);\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this4 = _possibleConstructorReturn(this, (_getPrototypeOf3 = _getPrototypeOf(ChatContainer)).call.apply(_getPrototypeOf3, [this].concat(args)));\n    _this4.state = {\n      usersList: {},\n      uid: 0,\n      midEdit: -1,\n      message: ''\n    };\n\n    _this4.messageEdited = function () {\n      var mid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;\n      var message = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      console.log(mid);\n\n      _this4.setEditMessage(mid, message);\n    };\n\n    return _this4;\n  }\n\n  _createClass(ChatContainer, [{\n    key: \"setEditMessage\",\n    value: function setEditMessage(mid, message) {\n      this.setState({\n        midEdit: mid,\n        message: message\n      });\n    }\n  }, {\n    key: \"setUsers\",\n    value: function setUsers(users) {\n      this.setState({\n        usersList: users\n      });\n    }\n  }, {\n    key: \"setUid\",\n    value: function setUid(uid) {\n      this.setState({\n        uid: uid\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"section\", {\n        id: \"chatSection\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, React.createElement(Chat, {\n        uid: this.state.uid,\n        usersList: this.state.usersList,\n        editMessage: this.messageEdited,\n        edditingMessage: this.state.midEdit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }), React.createElement(UserTyping, {\n        uid: this.state.uid,\n        usersList: this.state.usersList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }), React.createElement(MessageForm, {\n        editMessage: this.state.message,\n        midEdit: this.state.midEdit,\n        messageEdited: this.messageEdited,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }), React.createElement(UsersInfo, {\n        usersList: this.state.usersList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }));\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this5 = this;\n\n      socket.on('chatHistory', function (data) {\n        _this5.setUsers(data.userList);\n      });\n      socket.on('userLoggedIn', function (data) {\n        _this5.setUid(data.uid);\n      });\n      socket.on('toggleOnline', function (data) {\n        _this5.setUsers(data.usersList);\n      });\n      socket.on('chatNewUser', function (data) {\n        var users = _this5.state.usersList;\n        users[data.uid] = data.user;\n\n        _this5.setUsers(users);\n      });\n    }\n  }]);\n\n  return ChatContainer;\n}(React.Component);\n\nvar Chat =\n/*#__PURE__*/\nfunction (_React$Component4) {\n  _inherits(Chat, _React$Component4);\n\n  function Chat() {\n    var _getPrototypeOf4;\n\n    var _this6;\n\n    _classCallCheck(this, Chat);\n\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    _this6 = _possibleConstructorReturn(this, (_getPrototypeOf4 = _getPrototypeOf(Chat)).call.apply(_getPrototypeOf4, [this].concat(args)));\n    _this6.state = {\n      chatHistory: {}\n    };\n    _this6.lastReadMessage = 0;\n\n    _this6.scrollToBottom = function () {\n      var list = document.getElementById(\"chat\");\n      list.scrollTop = list.scrollHeight;\n    };\n\n    _this6.editMessage = function (mid) {\n      if (mid === '' || mid === _this6.props.edditingMessage) {\n        _this6.props.editMessage(-1, '');\n\n        return;\n      }\n\n      _this6.props.editMessage(mid, _this6.state.chatHistory[mid]['msg']);\n    };\n\n    return _this6;\n  }\n\n  _createClass(Chat, [{\n    key: \"setHistory\",\n    value: function setHistory(history) {\n      this.setState({\n        chatHistory: history\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this7 = this;\n\n      var date = '';\n      return React.createElement(\"div\", {\n        id: \"chat\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, Object.keys(this.state.chatHistory).map(function (i) {\n        var userChanged = false,\n            dateChanged = false;\n\n        if (date !== helperFunctions.parseDate(_this7.state.chatHistory[i]['date'])) {\n          date = helperFunctions.parseDate(_this7.state.chatHistory[i]['date']);\n          dateChanged = true;\n        }\n\n        if (_this7.lastMessageUid !== _this7.state.chatHistory[i]['user']) {\n          _this7.lastMessageUid = _this7.state.chatHistory[i]['user'];\n          userChanged = true;\n        }\n\n        return [dateChanged === true ? React.createElement(\"div\", {\n          className: \"newUser dateMessage\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 228\n          },\n          __self: this\n        }, date) : '', _this7.state.chatHistory[i]['isSystem'] === true ? React.createElement(SystemMessage, {\n          message: _this7.state.chatHistory[i],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 231\n          },\n          __self: this\n        }) : React.createElement(MessageItem, {\n          message: _this7.state.chatHistory[i],\n          userChanged: userChanged,\n          userName: userChanged === true ? _this7.props.usersList[_this7.lastMessageUid]['name'] : '',\n          userColor: userChanged === true ? _this7.props.usersList[_this7.lastMessageUid]['color'] : '',\n          uid: _this7.props.uid,\n          editMessage: _this7.editMessage,\n          mid: i,\n          isEdditing: _this7.props.edditingMessage === i ? true : false,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        })];\n      }));\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this8 = this;\n\n      socket.on('chatHistory', function (data) {\n        _this8.setHistory(data.chat);\n      });\n      socket.on('rewriteMessage', function (data) {\n        var changeMessage = _this8.state.chatHistory;\n        changeMessage[data.mid] = data.message;\n\n        _this8.setHistory(changeMessage);\n      });\n      socket.on('addMessage', function (data) {\n        var newMessage = _this8.state.chatHistory;\n        newMessage[data.id] = data.message;\n\n        _this8.setHistory(newMessage);\n      });\n      socket.on('readAll', function (data) {\n        var messages = _this8.state.chatHistory;\n\n        for (var i = _this8.lastReadMessage; i <= data.toMessage; i++) {\n          messages[i]['unread'] = false;\n        }\n\n        _this8.setHistory(messages);\n\n        _this8.lastReadMessage = data.toMessage;\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.scrollToBottom();\n    }\n  }]);\n\n  return Chat;\n}(React.Component);\n\nvar SystemMessage =\n/*#__PURE__*/\nfunction (_React$Component5) {\n  _inherits(SystemMessage, _React$Component5);\n\n  function SystemMessage() {\n    _classCallCheck(this, SystemMessage);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(SystemMessage).apply(this, arguments));\n  }\n\n  _createClass(SystemMessage, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"newUser\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272\n        },\n        __self: this\n      }, this.props.message['msg']);\n    }\n  }]);\n\n  return SystemMessage;\n}(React.Component);\n\nvar MessageItem =\n/*#__PURE__*/\nfunction (_React$Component6) {\n  _inherits(MessageItem, _React$Component6);\n\n  function MessageItem() {\n    _classCallCheck(this, MessageItem);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(MessageItem).apply(this, arguments));\n  }\n\n  _createClass(MessageItem, [{\n    key: \"render\",\n    value: function render() {\n      var _this9 = this;\n\n      var unread = this.props.message['unread'] === true ? 'unreadMessages ' : '';\n      var editting = this.props.isEdditing === true ? 'editingMessage' : '';\n      var messageClass = \"message_container \" + (this.props.message['isChanged'] === true ? 'editedMsg ' : '') + unread + ' ' + editting;\n      var userMessageClass = \"message_container \" + unread;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      }, this.props.userChanged === true ? React.createElement(\"div\", {\n        className: userMessageClass,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"date_name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287\n        },\n        __self: this\n      }, helperFunctions.parseTime(this.props.message['date']), React.createElement(\"p\", {\n        className: \"user\",\n        style: {\n          'color': this.props.userColor\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 288\n        },\n        __self: this\n      }, this.props.userName))) : '', React.createElement(\"div\", {\n        className: messageClass,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292\n        },\n        __self: this\n      }, React.createElement(Linkify, {\n        tagName: \"p\",\n        className: \"message\",\n        onClick: function onClick() {\n          return _this9.props.editMessage(_this9.props.uid === _this9.props.message['user'] ? _this9.props.mid : '');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293\n        },\n        __self: this\n      }, this.props.message['msg'])));\n    }\n  }]);\n\n  return MessageItem;\n}(React.Component);\n\nvar UsersInfo =\n/*#__PURE__*/\nfunction (_React$Component7) {\n  _inherits(UsersInfo, _React$Component7);\n\n  function UsersInfo() {\n    var _getPrototypeOf5;\n\n    var _this10;\n\n    _classCallCheck(this, UsersInfo);\n\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n\n    _this10 = _possibleConstructorReturn(this, (_getPrototypeOf5 = _getPrototypeOf(UsersInfo)).call.apply(_getPrototypeOf5, [this].concat(args)));\n    _this10.state = {\n      count: 0\n    };\n    return _this10;\n  }\n\n  _createClass(UsersInfo, [{\n    key: \"render\",\n    value: function render() {\n      var _this11 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"users_count\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308\n        },\n        __self: this\n      }, \"\\u0412 \\u0447\\u0430\\u0442\\u0435 \", this.state.count, \" \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\", helperFunctions.numericEnding(this.state.count, 'ль', 'ля', 'лей'), \".\"), React.createElement(\"div\", {\n        className: \"userList\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309\n        },\n        __self: this\n      }, Object.keys(this.props.usersList).map(function (i) {\n        return _this11.props.usersList[i]['inChat'] === false ? '' : React.createElement(\"p\", {\n          key: i,\n          className: _this11.props.usersList[i]['online'] === true ? 'user_online' : 'user_gone',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 312\n          },\n          __self: this\n        }, _this11.props.usersList[i]['name']);\n      })));\n    }\n  }, {\n    key: \"setCount\",\n    value: function setCount(count) {\n      this.setState({\n        count: count\n      });\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this12 = this;\n\n      socket.on('chatHistory', function (data) {\n        _this12.setCount(data.users);\n      });\n      socket.on('usersCount', function (data) {\n        _this12.setCount(data);\n      });\n    }\n  }]);\n\n  return UsersInfo;\n}(React.Component);\n\nvar UserTyping =\n/*#__PURE__*/\nfunction (_React$Component8) {\n  _inherits(UserTyping, _React$Component8);\n\n  function UserTyping() {\n    var _getPrototypeOf6;\n\n    var _this13;\n\n    _classCallCheck(this, UserTyping);\n\n    for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n      args[_key5] = arguments[_key5];\n    }\n\n    _this13 = _possibleConstructorReturn(this, (_getPrototypeOf6 = _getPrototypeOf(UserTyping)).call.apply(_getPrototypeOf6, [this].concat(args)));\n    _this13.state = {\n      text: ''\n    };\n    return _this13;\n  }\n\n  _createClass(UserTyping, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"p\", {\n        id: \"usersTyping\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 343\n        },\n        __self: this\n      }, this.state.text);\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this14 = this;\n\n      socket.on('usersTyping', function (data) {\n        _this14.setState({\n          text: data.users.length === 0 ? '' : data.users.join(', ') + ' печата' + (data.users.length > 1 ? 'ют' : 'ет') + ' сообщение:'\n        });\n      });\n    }\n  }]);\n\n  return UserTyping;\n}(React.Component);\n\nvar MessageForm =\n/*#__PURE__*/\nfunction (_React$Component9) {\n  _inherits(MessageForm, _React$Component9);\n\n  function MessageForm() {\n    var _getPrototypeOf7;\n\n    var _this15;\n\n    _classCallCheck(this, MessageForm);\n\n    for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n      args[_key6] = arguments[_key6];\n    }\n\n    _this15 = _possibleConstructorReturn(this, (_getPrototypeOf7 = _getPrototypeOf(MessageForm)).call.apply(_getPrototypeOf7, [this].concat(args)));\n    _this15.isTyping = false;\n    _this15.intervalStopTyping = '';\n\n    _this15.keyPress = function (e) {\n      if (helperFunctions.isEnterCtrlButton(e)) {\n        e.target.value += '\\r\\n';\n        return;\n      }\n\n      if (helperFunctions.isEnterButton(e)) {\n        e.preventDefault();\n        socket.emit('addMessage', {\n          'message': e.target.value,\n          mid: _this15.props.midEdit\n        });\n        e.target.value = '';\n\n        _this15.props.messageEdited(-1, '');\n\n        return;\n      }\n\n      clearTimeout(_this15.intervalStopTyping);\n      _this15.intervalStopTyping = setTimeout(_this15.stopTyping, 1000);\n      if (_this15.isTyping === true) return;\n      socket.emit('userTyping');\n      _this15.isTyping = true;\n    };\n\n    _this15.stopTyping = function () {\n      socket.emit('userStopTyping');\n      _this15.isTyping = false;\n    };\n\n    return _this15;\n  }\n\n  _createClass(MessageForm, [{\n    key: \"render\",\n    value: function render() {\n      var _this16 = this;\n\n      return React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 363\n        },\n        __self: this\n      }, React.createElement(\"textarea\", {\n        className: \"form-control\",\n        rows: \"3\",\n        defaultValue: this.props.editMessage,\n        onKeyDown: function onKeyDown(e) {\n          return _this16.keyPress(e);\n        },\n        ref: this.texarea,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 364\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return MessageForm;\n}(React.Component);\n\nvar Audio =\n/*#__PURE__*/\nfunction (_React$Component10) {\n  _inherits(Audio, _React$Component10);\n\n  function Audio() {\n    _classCallCheck(this, Audio);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Audio).apply(this, arguments));\n  }\n\n  _createClass(Audio, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"audio\", {\n        id: \"chatAudio\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 399\n        },\n        __self: this\n      }, React.createElement(\"source\", {\n        src: \"/src/notify.ogg\",\n        type: \"audio/ogg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 400\n        },\n        __self: this\n      }), React.createElement(\"source\", {\n        src: \"/src/notify.mp3\",\n        type: \"audio/mpeg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 401\n        },\n        __self: this\n      }), React.createElement(\"source\", {\n        src: \"/src/notify.wav\",\n        type: \"audio/wav\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 402\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Audio;\n}(React.Component);\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component11) {\n  _inherits(App, _React$Component11);\n\n  function App() {\n    var _getPrototypeOf8;\n\n    var _this17;\n\n    _classCallCheck(this, App);\n\n    for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n      args[_key7] = arguments[_key7];\n    }\n\n    _this17 = _possibleConstructorReturn(this, (_getPrototypeOf8 = _getPrototypeOf(App)).call.apply(_getPrototypeOf8, [this].concat(args)));\n    _this17.state = {\n      isUserSiggedIn: false,\n      isWindowOnFocus: true,\n      uid: -1\n    };\n\n    _this17.setUserStatus = function (val) {\n      _this17.setState({\n        isUserSiggedIn: val\n      });\n    };\n\n    _this17.setWindowFocus = function (val) {\n      _this17.setState({\n        isWindowOnFocus: val\n      });\n    };\n\n    _this17.readAll = function () {\n      if (_this17.state.isUserSiggedIn === true && _this17.state.isWindowOnFocus === true) socket.emit('readAll');\n    };\n\n    return _this17;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 418\n        },\n        __self: this\n      }, React.createElement(ChatContainer, {\n        uid: this.state.uid,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 419\n        },\n        __self: this\n      }), this.state.isUserSiggedIn === false ? React.createElement(LoginApp, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420\n        },\n        __self: this\n      }) : '', this.state.isWindowOnFocus === false ? React.createElement(Audio, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 421\n        },\n        __self: this\n      }) : '');\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this18 = this;\n\n      socket.on('loginUser', function (data) {\n        _this18.setUserStatus(false);\n      });\n      socket.on('addMessage', function (data) {\n        _this18.readAll();\n\n        if (_this18.state.isUserSiggedIn === true && _this18.state.isWindowOnFocus === false) document.getElementById('chatAudio').play();\n      });\n      socket.on('userLoggedIn', function (data) {\n        _this18.setUserStatus(true);\n      });\n      socket.on('returnUsername', function (data) {\n        _this18.setUserStatus(true);\n\n        _this18.setUid(data.uid);\n      });\n      socket.on('disconnect', function () {\n        _this18.setUserStatus(false);\n      });\n      window.addEventListener(\"focus\", function (event) {\n        _this18.setWindowFocus(true);\n\n        socket.emit('toggleOnline');\n\n        _this18.readAll();\n      });\n      window.addEventListener(\"blur\", function (event) {\n        _this18.setWindowFocus(false);\n\n        socket.emit('toggleOnline');\n      });\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nReactDOM.render(React.createElement(App, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 476\n  },\n  __self: this\n}), appSection);","map":{"version":3,"sources":["G:\\OSPanel\\domains\\new_react\\src\\index.js"],"names":["React","ReactDOM","io","Linkify","appSection","document","getElementById","socket","connect","reconnect","helperFunctions","isEnterButton","e","keyCode","isEnterCtrlButton","ctrlKey","isEmptyValue","val","numericEnding","number","one","two","five","n","Math","abs","parseTime","date","time","Date","getHours","slice","getMinutes","parseDate","messageDate","searchDate","compareDates","setDate","getDate","getMonth","getFullYear","date1","date2","LoginWindow","props","checkEnterKey","error","Component","LoginApp","state","value","target","replace","incorrectLogin","clearError","sendLogin","emit","existLogin","setErrorStateFun","setState","on","ChatContainer","usersList","uid","midEdit","message","messageEdited","mid","console","log","setEditMessage","users","data","setUsers","userList","setUid","user","Chat","chatHistory","lastReadMessage","scrollToBottom","list","scrollTop","scrollHeight","editMessage","edditingMessage","history","Object","keys","map","i","userChanged","dateChanged","lastMessageUid","setHistory","chat","changeMessage","newMessage","id","messages","toMessage","SystemMessage","MessageItem","unread","editting","isEdditing","messageClass","userMessageClass","userColor","userName","UsersInfo","count","setCount","UserTyping","text","length","join","MessageForm","isTyping","intervalStopTyping","keyPress","preventDefault","clearTimeout","setTimeout","stopTyping","texarea","Audio","App","isUserSiggedIn","isWindowOnFocus","setUserStatus","setWindowFocus","readAll","play","window","addEventListener","event","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './style.css';\nimport './reset.css';\n//import * as serviceWorker from './serviceWorker';\nimport io from 'socket.io-client';\nimport Linkify from 'linkifyjs/react';\n\nconst appSection = document.getElementById('chatApp')\nconst socket = io.connect('http://127.0.0.1:5000/', {reconnect: true});\n\nconst helperFunctions = {\n\tisEnterButton : (e) => {\n\t\treturn (e.keyCode === 13) ? true : false;\n\t},\n\tisEnterCtrlButton : (e) => {\n\t\treturn ((e.keyCode === 10 || e.keyCode === 13) && e.ctrlKey) ? true : false;\n\t},\n\tisEmptyValue : (val) => {\n\t\treturn (val === '') ? true : false\n\t},\n\tnumericEnding : (number, one, two, five) => {\n\t    let n = Math.abs(number);\n\t    n %= 100;\n\t    if (n >= 5 && n <= 20) {\n\t    \treturn five;\n\t    }\n\t    n %= 10;\n\t    if (n === 1) {\n\t    \treturn one;\n\t    }\n\t    if (n >= 2 && n <= 4) {\n\t    \treturn two;\n\t    }\n\t    return five;\n\t},\n\tparseTime : (date) => {\n\t\tvar time = new Date(date);\n\t\treturn (\"0\" + time.getHours()).slice(-2)   + \":\" +  (\"0\" + time.getMinutes()).slice(-2) + \":\" ;\n\t},\n\tparseDate : (date) => {\n\t\tvar messageDate = new Date(date);\n\t\tvar searchDate = new Date();\n\t\tif(helperFunctions.compareDates(messageDate, searchDate))\n\t\t\treturn \"Сегодня\";\n\t\tsearchDate.setDate(searchDate.getDate()-1);\n\t\tif(helperFunctions.compareDates(messageDate, searchDate))\n\t\t\treturn \"Вчера\";\n\t\treturn messageDate.getDate()+'.'+messageDate.getMonth()+'.'+messageDate.getFullYear();\n\t},\n\tcompareDates : (date1, date2) => {\n\t\treturn (date1.getMonth() === date2.getMonth() && date1.getFullYear() === date2.getFullYear() &&  date1.getDate() === date2.getDate()) ? true : false;\n\t}\n};\n\nclass LoginWindow extends React.Component {   \n\trender() { \n\t\treturn (\n\t\t   \t<div className=\"username\">\n\t\t   \t<h1>Введите имя</h1>\n\t\t   \t<input type=\"text\" id='nickname' onKeyUp={(e) => this.props.checkEnterKey(e)} />\n\t\t   \t<p className='userWarning' >{this.props.error}</p>\n\t\t   \t</div>\n\t\t);\n\t} \n}\n\nclass LoginApp extends React.Component {\n\tstate = {\n\t\terror : ''\n\t}\n\t\n\tcheckEnterKey = (e, val) => {\n\t\tvar value = e.target.value.replace(/ /g, \"\");\n\t\tif(helperFunctions.isEmptyValue(value)){\n\t\t\tthis.incorrectLogin();\n\t\t\treturn;\n\t\t}\n\t\tthis.clearError();\n\t\tif(!helperFunctions.isEnterButton(e))\n\t\t\treturn;\n\t\tthis.sendLogin(value);\n\t}\n\n\tsendLogin = (val) => {\n\t\tsocket.emit('userName', {'user': val});\n\t}\n\n\texistLogin = () => {\n\t\tthis.setErrorStateFun('Такой пользователь уже есть');\n\t}\n\n\tincorrectLogin = () => {\n\t\tthis.setErrorStateFun('Недопустимое имя');\n\t}\n\n\tclearError = () => {\n\t\tthis.setErrorStateFun('');\n\t}\n\n\tsetErrorStateFun = (val) => {\n\t\tthis.setState({\n\t\t\terror : val\n\t\t})\n\t}\n\n\trender() {\n\t\treturn <LoginWindow error={this.state.error} checkEnterKey={this.checkEnterKey} />;\n\t}\n\n\tcomponentWillMount() {\n        socket.on('existUsername', () => {\n            this.existLogin();\n        });\n        socket.on('incorrectUsername', () => {\n            this.incorrectLogin();\n        });\n    }\n}\n\nclass ChatContainer extends React.Component { \n\tstate = {\n\t\tusersList : {},\n\t\tuid : 0,\n\t\tmidEdit : -1,\n\t\tmessage : ''\n\t}\n\n\tsetEditMessage (mid, message){\n\t\tthis.setState({\n\t\t\tmidEdit : mid,\n\t\t\tmessage : message\n\t\t});\n\t}\n\n\tsetUsers (users) {\n\t\tthis.setState({\n\t\t\tusersList : users\n\t\t});\n\t}\n\n\tsetUid (uid) {\n\t\tthis.setState({\n\t\t\tuid : uid\n\t\t});\n\t}\n\n\tmessageEdited = (mid = -1, message = '') => {\n\t\tconsole.log(mid);\n\t\tthis.setEditMessage(mid, message);\n\t}\n\n\trender() { \n\t\treturn (\n\t\t<section id='chatSection'>\n\t\t\t<Chat uid={this.state.uid} usersList={this.state.usersList} editMessage={this.messageEdited} edditingMessage={this.state.midEdit} />\n\t\t\t<UserTyping uid={this.state.uid} usersList={this.state.usersList}/>\n\t\t\t<MessageForm editMessage={this.state.message} midEdit={this.state.midEdit} messageEdited={this.messageEdited} />\n\t\t\t<UsersInfo usersList={this.state.usersList}/>\n\t\t</section>\n\t\t);\n\t} \n\n\tcomponentWillMount() {\n\t\tsocket.on('chatHistory', (data) => {\n\t\t\tthis.setUsers(data.userList);\n\t\t});\n\t\tsocket.on('userLoggedIn', (data) => {\n\t\t\tthis.setUid(data.uid);\n\t\t});\n\t\tsocket.on('toggleOnline', (data) => {\n\t\t\tthis.setUsers(data.usersList);\n\t\t});\n\t\tsocket.on('chatNewUser', (data) => {\n\t\t\tvar users = this.state.usersList;\n\t\t\tusers[data.uid] = data.user;\n\t\t\tthis.setUsers(users);\n\t\t});\n    }\n\n}\n\nclass Chat extends React.Component { \n\tstate = {\n\t\tchatHistory : {},\n\t}\n\n\tlastReadMessage = 0; \n\n\tsetHistory (history) {\n\t\tthis.setState({\n\t\t\tchatHistory : history\n\t\t});\n\t}\n\n\tscrollToBottom = () => {\n\t\tvar list = document.getElementById(\"chat\");\n\t\tlist.scrollTop = list.scrollHeight;\n\t}\n\n\teditMessage = (mid) => {\n\t\tif(mid === '' || mid === this.props.edditingMessage){\n\t\t\tthis.props.editMessage(-1, '');\n\t\t\treturn;\n\t\t}\n\t\tthis.props.editMessage(mid, this.state.chatHistory[mid]['msg']);\n\t}\n\n\trender() { \n\t\tlet date = '';\n\t\treturn (\n\t\t    <div id=\"chat\">\n\t\t\t\t{Object.keys(this.state.chatHistory).map(i => {\n\t\t\t\t\tlet userChanged = false,\n\t\t\t\t\t\tdateChanged = false;\n\n\t\t\t\t\tif(date !== helperFunctions.parseDate(this.state.chatHistory[i]['date'])){\n\t\t\t\t\t\tdate = helperFunctions.parseDate(this.state.chatHistory[i]['date']);\n\t\t\t\t\t\tdateChanged = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.lastMessageUid !== this.state.chatHistory[i]['user']){\n\t\t\t\t\t\tthis.lastMessageUid = this.state.chatHistory[i]['user'];\n\t\t\t\t\t\tuserChanged = true;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [\n\t\t\t\t\t\t(dateChanged === true) ?  \n\t\t\t\t\t\t<div className=\"newUser dateMessage\">{date}</div>\n\t\t\t\t\t \t: '',\n\t\t\t\t\t\t(this.state.chatHistory[i]['isSystem'] === true) ?\n\t\t\t\t\t\t<SystemMessage message={this.state.chatHistory[i]} /> :\n\t\t\t\t\t\t<MessageItem message={this.state.chatHistory[i]} userChanged={userChanged} userName={(userChanged === true) ? this.props.usersList[this.lastMessageUid]['name'] : ''}  userColor={(userChanged === true) ? this.props.usersList[this.lastMessageUid]['color'] : ''} uid={this.props.uid} editMessage={this.editMessage} mid={i} isEdditing={this.props.edditingMessage === i ? true : false} />\n\t\t\t\t\t]\n\t\t\t\t\t\n\t\t\t\t})}\n\t\t\t</div>\n\t\t);\n\t} \n\n\tcomponentWillMount() {\n\t\tsocket.on('chatHistory', (data) => {\n\t\t\tthis.setHistory(data.chat);\n\t\t});\n\t\tsocket.on('rewriteMessage', (data) => {\n\t\t\tvar changeMessage = this.state.chatHistory;\n\t\t\tchangeMessage[data.mid] = data.message;\n\t\t\tthis.setHistory(changeMessage);\n\t\t});\n\t\tsocket.on('addMessage', (data) => {\n\t\t\tvar newMessage = this.state.chatHistory;\n\t\t\tnewMessage[data.id] = data.message;\n\t\t\tthis.setHistory(newMessage);\n\t\t});\n\t\tsocket.on('readAll', (data) => {\n\t\t\tvar messages = this.state.chatHistory;\n\t\t\tfor(let i = this.lastReadMessage; i<= data.toMessage; i++){\n\t\t\t\tmessages[i]['unread'] = false;\n\t\t\t}\n\t\t\tthis.setHistory(messages);\n\t\t\tthis.lastReadMessage = data.toMessage;\n\t\t});\n    }\n\n    componentDidUpdate() {\n\t\tthis.scrollToBottom();\n\t}\n}\n\nclass SystemMessage extends React.Component {\n\trender() { \n\t\treturn (\n\t\t    <div className=\"newUser\">{this.props.message['msg']}</div>\n\t\t)\n\t}\n}\n\nclass MessageItem extends React.Component {\n\trender() { \n\t\tlet unread = (this.props.message['unread'] === true ? 'unreadMessages ' : '');\n\t\tlet editting = (this.props.isEdditing === true ? 'editingMessage' : '');\n\t\tlet messageClass = \"message_container \" + (this.props.message['isChanged'] === true ? 'editedMsg ' : '') + unread + ' ' + editting;\n\t\tlet userMessageClass = \"message_container \"+unread;\n\t\treturn (\n\t\t    <div>\n\t\t\t\t{(this.props.userChanged === true) ?  \n\t\t\t\t\t<div className={userMessageClass}>\n\t\t\t\t\t\t<div className=\"date_name\">{helperFunctions.parseTime(this.props.message['date'])}\n\t\t\t\t\t\t\t<p className=\"user\" style={{'color' : this.props.userColor}} >{this.props.userName}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t : '' }\n\t\t\t    <div className={messageClass}>\n\t\t\t    <Linkify tagName=\"p\" className=\"message\" onClick={() => this.props.editMessage(this.props.uid === this.props.message['user'] ? this.props.mid : '')}>{this.props.message['msg']}</Linkify>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nclass UsersInfo extends React.Component { \n\tstate = {\n\t\tcount : 0,\n\t}\n\n\trender() { \n\t\treturn (\n\t\t    <div>\n\t\t    \t<div id=\"users_count\">В чате {this.state.count} пользовате{helperFunctions.numericEnding(this.state.count, 'ль', 'ля', 'лей')}.</div>\n\t\t\t\t<div className=\"userList\">\n\t\t\t\t    {Object.keys(this.props.usersList).map(i => (\n\t\t\t\t    \t(this.props.usersList[i]['inChat'] === false ) ? '' : \n\t\t\t\t\t\t<p key={i} className={this.props.usersList[i]['online'] === true ? 'user_online' : 'user_gone'} >{this.props.usersList[i]['name']}</p>\n\t\t\t\t\t))}\n\n\t\t\t\t</div>\n\t\t    </div>\n\t\t);\n\t} \n\n\tsetCount (count) {\n\t\tthis.setState({\n\t\t\tcount : count\n\t\t});\n\t}\n\n\tcomponentWillMount() {\n\t\tsocket.on('chatHistory', (data) => {\n\t\t\tthis.setCount(data.users);\n\t\t});\n\t\tsocket.on('usersCount', (data) => {\n\t\t\tthis.setCount(data);\n\t\t});\n    }\n}\n\nclass UserTyping extends React.Component { \n\tstate = {\n\t\ttext : '',\n\t}\n\n\trender() { \n\t\treturn (\n\t\t    <p id='usersTyping'>{this.state.text}</p>\n\t\t);\n\t} \n\n\tcomponentWillMount() {\n\t\tsocket.on( 'usersTyping', (data) => {\n\t\t\tthis.setState({\n\t\t\t\ttext : ( (data.users.length === 0) ? '' : data.users.join(', ')+' печата'+(data.users.length > 1 ? 'ют' : 'ет')+' сообщение:')\n\t\t\t});\n\t\t})\n    }\n}\n\n\nclass MessageForm extends React.Component { \n\tisTyping = false;\n\tintervalStopTyping = '';\n\n\trender() { \n\t\treturn (\n\t\t    <div className=\"form-group\">\n\t\t\t\t<textarea className=\"form-control\" rows=\"3\" defaultValue={this.props.editMessage} onKeyDown={(e) => this.keyPress(e)} ref={this.texarea}  />\n\t\t\t</div>\n\t\t);\n\t} \n\n\tkeyPress = (e) => {\n\t\tif(helperFunctions.isEnterCtrlButton(e)){\n\t\t\te.target.value += '\\r\\n';\n\t\t\treturn;\n\t\t}\n\t\tif(helperFunctions.isEnterButton(e)){\n\t\t\te.preventDefault();\n\t\t\tsocket.emit('addMessage', {'message': e.target.value, mid : this.props.midEdit});\n\t\t\te.target.value = '';\n\t\t\tthis.props.messageEdited(-1, '');\n\t\t\treturn;\n\t\t}\n\t\tclearTimeout(this.intervalStopTyping);\n\t\tthis.intervalStopTyping = setTimeout(this.stopTyping, 1000);\n\t\tif(this.isTyping === true)\n\t\t\treturn;\n\t\tsocket.emit('userTyping');\n\t\tthis.isTyping = true;\n\t}\n\n\tstopTyping = () => {\n\t\tsocket.emit('userStopTyping');\n\t\tthis.isTyping = false;\n\t}\n\n}\n\nclass Audio extends React.Component {   \n\trender() { \n\t\treturn (\n\t\t   \t<audio id=\"chatAudio\">\n\t\t\t   \t<source src=\"/src/notify.ogg\" type=\"audio/ogg\" />\n\t\t\t   \t<source src=\"/src/notify.mp3\" type=\"audio/mpeg\" />\n\t\t\t   \t<source src=\"/src/notify.wav\" type=\"audio/wav\" />\n\t\t   \t</audio>\n\t\t);\n\t} \n}\n\n\nclass App extends React.Component {\n\tstate = {\n\t\tisUserSiggedIn : false,\n\t\tisWindowOnFocus : true,\n\t\tuid : -1\n\t}\n\n\trender() {\n\t\treturn (\n\t\t        <div>\n\t\t        \t<ChatContainer uid={this.state.uid} />\n\t\t        \t{(this.state.isUserSiggedIn === false) ? <LoginApp /> : ''}\n\t\t        \t{(this.state.isWindowOnFocus === false) ? <Audio /> : ''}\n\t\t        </div>\n\t\t        );\n\t}\n\n\tsetUserStatus = (val) => {\n\t\tthis.setState({\n\t\t\tisUserSiggedIn : val\n\t\t});\n\t}\n\n\tsetWindowFocus = (val) => {\n\t\tthis.setState({\n\t\t\tisWindowOnFocus : val\n\t\t});\n\t}\n\n\treadAll = () => {\n\t\tif(this.state.isUserSiggedIn === true && this.state.isWindowOnFocus === true)\n\t\t\tsocket.emit('readAll');\n\t}\n\n\tcomponentWillMount() {\n\t\tsocket.on('loginUser', (data) => {\n\t\t\tthis.setUserStatus(false);\n\t\t});\n\t\tsocket.on('addMessage', (data) => {\n\t\t\tthis.readAll();\n\t\t\tif(this.state.isUserSiggedIn === true && this.state.isWindowOnFocus === false)\n\t\t\t\tdocument.getElementById('chatAudio').play();\n\t\t});\n\t\tsocket.on('userLoggedIn', (data) => {\n\t\t\tthis.setUserStatus(true);\n\t\t});\n\t\tsocket.on('returnUsername', (data) => {\n\t\t\tthis.setUserStatus(true);\n\t\t\tthis.setUid(data.uid);\n\t\t});\n\t\tsocket.on('disconnect', () => {\n\t\t\tthis.setUserStatus(false);\n\t\t});\n\t\twindow.addEventListener(\"focus\", (event) => {\n\t\t\tthis.setWindowFocus(true);\n\t\t\tsocket.emit('toggleOnline');\n\t\t\tthis.readAll();\n\t\t})\n\t\twindow.addEventListener(\"blur\", (event) => {\n\t\t\tthis.setWindowFocus(false);\n\t\t\tsocket.emit('toggleOnline');\n\t\t})\n    }\n\t\n}\n\nReactDOM.render(\n\t<App />, appSection\n)"]},"metadata":{},"sourceType":"module"}